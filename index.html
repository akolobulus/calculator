<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculator App</title>
 <style>
    /* Reset & Basic Styling */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  /* Soft pink page background */
  background: linear-gradient(145deg, #ffd5e5 0%, #ffbad9 100%);
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

/* Calculator Container */
.calculator {
  /* Light “white/pink” body for the calculator */
  background-color: #fff;
  border-radius: 15px;
  padding: 20px;
  width: 100%;
  max-width: 350px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}

/* Display Area with two lines: operation & result */
.display {
  /* Subtle pink tint behind the display */
  background-color: #ffeaf5;
  color: #333;
  padding: 15px;
  text-align: right;
  border-radius: 10px;
  margin-bottom: 15px;
  min-height: 60px;
  overflow: hidden;
}
.operation {
  font-size: 0.8em;
  opacity: 0.8;
  color: #666;
}
.result {
  font-size: 2em;
  word-wrap: break-word;
}

/* Grid for buttons (4 columns, 5 rows) */
.buttons {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 10px;
}

/* Button General Styling */
button {
  border: none;
  border-radius: 8px;
  font-size: 1.2em;
  padding: 15px;
  color: #fff;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

/* Digit Buttons & Decimal (pastel pink) */
.digit {
  background-color: #ff9aba; /* Pink */
}
.digit:hover {
  background-color: #ff85ab;
}

/* Special Buttons (AC, C, %) - deeper pink */
.red-btn {
  background-color: #ff7ca8;
}
.red-btn:hover {
  background-color: #ff6696;
}

/* Operator Buttons (green-btn -> purple now) */
.green-btn {
  background-color: #c895ff; /* Pastel purple */
}
.green-btn:hover {
  background-color: #b97afc;
}

@media (max-width: 480px) {
  .calculator {
    margin: 10px;
    padding: 15px;
  }
  button {
    font-size: 1em;
    padding: 10px;
  }
  .result {
    font-size: 1.5em;
  }
}
 </style>
</head>
<body>
  <div class="calculator">
    <!-- Dual display: operation & main result -->
    <div class="display">
      <div class="operation"></div>
      <div class="result">0</div>
    </div>

    <!-- Buttons -->
    <div class="buttons">
      <!-- Row 1: AC, C, %, ÷ -->
      <button class="red-btn" value="AC">AC</button>
      <button class="red-btn" value="C">C</button>
      <button class="red-btn" value="%">%</button>
      <button class="green-btn" value="/">÷</button>

      <!-- Row 2: 7, 8, 9, × -->
      <button class="digit" value="7">7</button>
      <button class="digit" value="8">8</button>
      <button class="digit" value="9">9</button>
      <button class="green-btn" value="*">×</button>

      <!-- Row 3: 4, 5, 6, - -->
      <button class="digit" value="4">4</button>
      <button class="digit" value="5">5</button>
      <button class="digit" value="6">6</button>
      <button class="green-btn" value="-">-</button>

      <!-- Row 4: 1, 2, 3, + -->
      <button class="digit" value="1">1</button>
      <button class="digit" value="2">2</button>
      <button class="digit" value="3">3</button>
      <button class="green-btn" value="+">+</button>

      <!-- Row 5: 0, 00, ., = -->
      <button class="digit" value="0">0</button>
      <button class="digit" value="00">00</button>
      <button class="digit" value=".">.</button>
      <button class="green-btn" value="=">=</button>
    </div>
  </div>

<script>
    
const operationDisplay = document.querySelector('.operation');
const resultDisplay = document.querySelector('.result');

let currentValue = '0';
let expression = '';
let lastResult = null;
let lastOperator = null;
let lastOperand = null;

document.querySelectorAll('button').forEach(button => {
  button.addEventListener('click', handleButtonClick);
});

function handleButtonClick(e) {
  const { value } = e.target;
  switch (value) {
    case 'AC': resetCalculator(); break;
    case 'C': clearEntry(); break;
    case '%': handlePercent(); break;
    case '+': case '-': case '*': case '/': handleOperator(value); break;
    case '=': handleEquals(); break;
    case '.': handleDecimal(); break;
    default: handleNumber(value); break;
  }
}

function handleNumber(num) {
  if (currentValue === '0' || currentValue === 'Error') {
    currentValue = num;
  } else {
    currentValue += num;
  }
  updateDisplay();
}

function handleDecimal() {
  if (!currentValue.includes('.')) {
    currentValue += '.';
    updateDisplay();
  }
}

function handleOperator(nextOperator) {
  if (currentValue === 'Error') return;
  
  // Validate currentValue before adding to expression
  if (currentValue === '.' || isNaN(currentValue)) {
    currentValue = '0';
  }

  if (currentValue !== '0' || currentValue.includes('.')) {
    expression += currentValue;
    currentValue = '0';
  }

  const lastChar = expression.slice(-1);
  if ('+-*/'.includes(lastChar)) {
    expression = expression.slice(0, -1) + nextOperator;
  } else {
    expression += nextOperator;
  }

  operationDisplay.textContent = expression;
  updateDisplay();
}

function handleEquals() {
  if (expression === '' && lastOperator !== null) {
    // Repeat last operation
    const currentNum = parseFloat(currentValue);
    const result = calculate(lastResult, currentNum, lastOperator);
    currentValue = result.toString();
    lastResult = result;
    operationDisplay.textContent = `${lastResult} ${lastOperator} ${currentNum} =`;
    updateDisplay();
    return;
  }

  if (expression === '') return;

  expression += currentValue;
  let result;
  try {
    result = eval(expression.replace(/×/g, '*').replace(/÷/g, '/'));
    if (result === Infinity || isNaN(result)) result = 'Error';
  } catch (e) {
    result = 'Error';
  }

  // Store last operator and operand
  const operators = ['+', '-', '*', '/'];
  let opIndex = -1;
  for (let i = expression.length - 1; i >= 0; i--) {
    if (operators.includes(expression[i])) {
      opIndex = i;
      break;
    }
  }

  if (opIndex !== -1 && result !== 'Error') {
    lastOperator = expression[opIndex];
    lastOperand = parseFloat(expression.substring(opIndex + 1));
    lastResult = result;
  }

  operationDisplay.textContent = expression + ' =';
  currentValue = result.toString();
  expression = '';
  updateDisplay();
}

function handlePercent() {
  const num = parseFloat(currentValue);
  currentValue = (num / 100).toString();
  updateDisplay();
}

function clearEntry() {
  currentValue = '0';
  updateDisplay();
}

function resetCalculator() {
  currentValue = '0';
  expression = '';
  lastResult = lastOperator = lastOperand = null;
  operationDisplay.textContent = '';
  updateDisplay();
}

function calculate(a, b, op) {
  switch (op) {
    case '+': return a + b;
    case '-': return a - b;
    case '*': return a * b;
    case '/': return b !== 0 ? a / b : 'Error';
    default: return 'Error';
  }
}

function updateDisplay() {
  if (currentValue === 'Error') {
    resultDisplay.textContent = 'Error';
    return;
  }
  resultDisplay.textContent = currentValue.length > 10 
    ? parseFloat(currentValue).toExponential(5) 
    : currentValue;
}
</script>
</body>
</html>
